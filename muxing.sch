EESchema Schematic File Version 4
EELAYER 30 0
EELAYER END
$Descr A4 11693 8268
encoding utf-8
Sheet 4 12
Title "USB Whisperer"
Date "2021-11-21"
Rev "A"
Comp "AllThingsEmbedded"
Comment1 "Javier Alvarez"
Comment2 ""
Comment3 ""
Comment4 ""
$EndDescr
Text HLabel 10050 5950 0    50   BiDi ~ 0
USB_DEV_1_D-
Text HLabel 10050 6050 0    50   BiDi ~ 0
USB_DEV_1_D+
Text HLabel 10050 5700 0    50   BiDi ~ 0
USB_DEV_2_D-
Text HLabel 10050 5800 0    50   BiDi ~ 0
USB_DEV_2_D+
Text HLabel 10050 6200 0    50   BiDi ~ 0
SBU_1
Text HLabel 10050 6300 0    50   BiDi ~ 0
SBU_2
Text HLabel 10050 5450 0    50   BiDi ~ 0
I2C2_SCL
Text HLabel 10050 5550 0    50   BiDi ~ 0
I2C2_SDA
Text HLabel 3750 4750 0    50   Input ~ 0
BUS_3_MUX_SEL_0
Text Label 10350 5700 0    50   ~ 0
USB_DEV_2_D-
Text Label 10350 5800 0    50   ~ 0
USB_DEV_2_D+
Wire Wire Line
	10350 5700 10050 5700
Wire Wire Line
	10050 5800 10350 5800
Text Label 10350 5950 0    50   ~ 0
USB_DEV_1_D-
Text Label 10350 6050 0    50   ~ 0
USB_DEV_1_D+
Wire Wire Line
	10350 5950 10050 5950
Wire Wire Line
	10050 6050 10350 6050
Text Label 10350 5450 0    50   ~ 0
I2C2_SCL
Text Label 10350 5550 0    50   ~ 0
I2C2_SDA
Wire Wire Line
	10350 5450 10050 5450
Wire Wire Line
	10050 5550 10350 5550
Text Label 10350 6200 0    50   ~ 0
SBU_1
Text Label 10350 6300 0    50   ~ 0
SBU_2
Wire Wire Line
	10350 6200 10050 6200
Wire Wire Line
	10050 6300 10350 6300
Text Label 3200 2150 0    50   ~ 0
USB_DEV_1_D+
Wire Wire Line
	3850 2150 3200 2150
Text Label 3200 2250 0    50   ~ 0
USB_DEV_1_D-
Wire Wire Line
	3850 2250 3200 2250
Text Label 4950 2150 0    50   ~ 0
TR_UART1_TX
Text Label 4950 2250 0    50   ~ 0
TR_UART1_RX
Wire Wire Line
	4850 2150 4950 2150
Wire Wire Line
	4950 2250 4850 2250
Wire Wire Line
	4950 2400 4850 2400
Wire Wire Line
	4850 2500 4950 2500
Text Label 4950 2400 0    50   ~ 0
I2C2_SCL
Text Label 4950 2500 0    50   ~ 0
I2C2_SDA
$Sheet
S 7100 2000 1000 950 
U 61D663B4
F0 "DEV MUX 2" 50
F1 "mux_dev.sch" 50
F2 "SEL0" I L 7100 2750 50 
F3 "SEL1" I L 7100 2850 50 
F4 "TARGET_D+" I L 7100 2150 50 
F5 "TARGET_D-" I L 7100 2250 50 
F6 "UART_TX" I R 8100 2150 50 
F7 "UART_RX" I R 8100 2250 50 
F8 "I2C_SCL" I R 8100 2400 50 
F9 "I2C_SDA" I R 8100 2500 50 
F10 "OE_N" I L 7100 2650 50 
$EndSheet
Text Label 6450 2150 0    50   ~ 0
USB_DEV_2_D+
Wire Wire Line
	7100 2150 6450 2150
Text Label 6450 2250 0    50   ~ 0
USB_DEV_2_D-
Wire Wire Line
	7100 2250 6450 2250
Text Label 8200 2150 0    50   ~ 0
TR_UART2_TX
Text Label 8200 2250 0    50   ~ 0
TR_UART2_RX
Wire Wire Line
	8100 2150 8200 2150
Wire Wire Line
	8200 2250 8100 2250
Wire Wire Line
	8200 2400 8100 2400
Wire Wire Line
	8100 2500 8200 2500
Text Label 8200 2400 0    50   ~ 0
I2C2_SCL
Text Label 8200 2500 0    50   ~ 0
I2C2_SDA
$Sheet
S 3850 4000 1000 950 
U 61D84977
F0 "DEV MUX 3" 50
F1 "mux_dev.sch" 50
F2 "SEL0" I L 3850 4750 50 
F3 "SEL1" I L 3850 4850 50 
F4 "TARGET_D+" I L 3850 4150 50 
F5 "TARGET_D-" I L 3850 4250 50 
F6 "UART_TX" I R 4850 4150 50 
F7 "UART_RX" I R 4850 4250 50 
F8 "I2C_SCL" I R 4850 4400 50 
F9 "I2C_SDA" I R 4850 4500 50 
F10 "OE_N" I L 3850 4650 50 
$EndSheet
Text Label 3200 4150 0    50   ~ 0
SBU_1
Wire Wire Line
	3850 4150 3200 4150
Text Label 3200 4250 0    50   ~ 0
SBU_2
Wire Wire Line
	3850 4250 3200 4250
Text Label 4950 4150 0    50   ~ 0
TR_UART3_TX
Text Label 4950 4250 0    50   ~ 0
TR_UART3_RX
Wire Wire Line
	4850 4150 4950 4150
Wire Wire Line
	4950 4250 4850 4250
Wire Wire Line
	4950 4400 4850 4400
Wire Wire Line
	4850 4500 4950 4500
Text Label 4950 4400 0    50   ~ 0
I2C2_SCL
Text Label 4950 4500 0    50   ~ 0
I2C2_SDA
Text HLabel 3750 2650 0    50   Input ~ 0
BUS_1_OE_N
Text HLabel 7000 2650 0    50   Input ~ 0
BUS_2_OE_N
Text HLabel 3750 4650 0    50   Input ~ 0
BUS_3_OE_N
Text Label 4550 6450 0    50   ~ 0
TR_UART1_TX
Text Label 4550 6550 0    50   ~ 0
TR_UART1_RX
Text Label 4550 6650 0    50   ~ 0
TR_UART2_TX
Text Label 4550 6750 0    50   ~ 0
TR_UART2_RX
Text Label 4550 6850 0    50   ~ 0
TR_UART3_TX
Text Label 4550 6950 0    50   ~ 0
TR_UART3_RX
Text HLabel 3750 4850 0    50   Input ~ 0
BUS_3_MUX_SEL_1
Text HLabel 7000 2750 0    50   Input ~ 0
BUS_2_MUX_SEL_0
Text HLabel 7000 2850 0    50   Input ~ 0
BUS_2_MUX_SEL_1
Text HLabel 3750 2750 0    50   Input ~ 0
BUS_1_MUX_SEL_0
Text HLabel 3750 2850 0    50   Input ~ 0
BUS_1_MUX_SEL_1
$Sheet
S 3850 2000 1000 950 
U 61D2FA96
F0 "DEV MUX 1" 50
F1 "mux_dev.sch" 50
F2 "SEL0" I L 3850 2750 50 
F3 "SEL1" I L 3850 2850 50 
F4 "TARGET_D+" I L 3850 2150 50 
F5 "TARGET_D-" I L 3850 2250 50 
F6 "UART_TX" I R 4850 2150 50 
F7 "UART_RX" I R 4850 2250 50 
F8 "I2C_SCL" I R 4850 2400 50 
F9 "I2C_SDA" I R 4850 2500 50 
F10 "OE_N" I L 3850 2650 50 
$EndSheet
$Sheet
S 3150 6350 1300 700 
U 619F3501
F0 "Voltage Level Translation" 50
F1 "level_translation.sch" 50
F2 "UART1_TX" I L 3150 6450 50 
F3 "UART1_RX" O L 3150 6550 50 
F4 "UART2_TX" I L 3150 6650 50 
F5 "UART2_RX" O L 3150 6750 50 
F6 "UART3_TX" I L 3150 6850 50 
F7 "UART3_RX" O L 3150 6950 50 
F8 "TR_UART1_TX" O R 4450 6450 50 
F9 "TR_UART1_RX" I R 4450 6550 50 
F10 "TR_UART2_TX" O R 4450 6650 50 
F11 "TR_UART2_RX" I R 4450 6750 50 
F12 "TR_UART3_TX" O R 4450 6850 50 
F13 "TR_UART3_RX" I R 4450 6950 50 
$EndSheet
Wire Wire Line
	4450 6450 4550 6450
Wire Wire Line
	4550 6550 4450 6550
Wire Wire Line
	4450 6650 4550 6650
Wire Wire Line
	4550 6750 4450 6750
Wire Wire Line
	4450 6850 4550 6850
Wire Wire Line
	4550 6950 4450 6950
$Sheet
S 7050 4000 1250 1050
U 61A7ECF3
F0 "USB MUX" 50
F1 "usb_mux.sch" 50
F2 "OE_N" I L 7050 4650 50 
F3 "SEL0" I L 7050 4750 50 
F4 "SEL1" I L 7050 4850 50 
F5 "TARGET_D+" I L 7050 4150 50 
F6 "TARGET_D-" I L 7050 4250 50 
F7 "DEV1_D+" I R 8300 4150 50 
F8 "DEV1_D-" I R 8300 4250 50 
F9 "DEV2_D+" I R 8300 4400 50 
F10 "DEV2_D-" I R 8300 4500 50 
F11 "DEV3_D+" I R 8300 4650 50 
F12 "DEV3_D-" I R 8300 4750 50 
$EndSheet
Text HLabel 6900 4750 0    50   Input ~ 0
USB_MUX_SEL_0
Text HLabel 6900 4850 0    50   Input ~ 0
USB_MUX_SEL_1
Text HLabel 6900 4650 0    50   Input ~ 0
USB_OE_N
Text Label 8450 4150 0    50   ~ 0
USB_DEV_1_D+
Text Label 8450 4250 0    50   ~ 0
USB_DEV_1_D-
Text Label 8450 4400 0    50   ~ 0
USB_DEV_2_D+
Text Label 8450 4500 0    50   ~ 0
USB_DEV_2_D-
Text Label 8450 4650 0    50   ~ 0
SBU_1
Text Label 8450 4750 0    50   ~ 0
SBU_2
Wire Wire Line
	8450 4150 8300 4150
Wire Wire Line
	8450 4250 8300 4250
Wire Wire Line
	8300 4400 8450 4400
Wire Wire Line
	8450 4500 8300 4500
Wire Wire Line
	8300 4650 8450 4650
Wire Wire Line
	8450 4750 8300 4750
Wire Wire Line
	7050 4650 6900 4650
Wire Wire Line
	6900 4750 7050 4750
Wire Wire Line
	7050 4850 6900 4850
Text HLabel 3000 6450 0    50   Input ~ 0
UART1_TX
Text HLabel 3000 6550 0    50   Output ~ 0
UART1_RX
Text HLabel 3000 6650 0    50   Input ~ 0
UART2_TX
Text HLabel 3000 6750 0    50   Output ~ 0
UART2_RX
Text HLabel 3000 6850 0    50   Input ~ 0
UART3_TX
Text HLabel 3000 6950 0    50   Output ~ 0
UART3_RX
Wire Wire Line
	3000 6450 3150 6450
Wire Wire Line
	3150 6550 3000 6550
Wire Wire Line
	3000 6650 3150 6650
Wire Wire Line
	3150 6750 3000 6750
Wire Wire Line
	3000 6850 3150 6850
Wire Wire Line
	3150 6950 3000 6950
Text HLabel 6900 4150 0    50   BiDi ~ 0
USB_AUX_D+
Text HLabel 6900 4250 0    50   BiDi ~ 0
USB_AUX_D-
Wire Wire Line
	6900 4150 7050 4150
Wire Wire Line
	7050 4250 6900 4250
Wire Wire Line
	7100 2650 7000 2650
Wire Wire Line
	7000 2750 7100 2750
Wire Wire Line
	7100 2850 7000 2850
Wire Wire Line
	3850 2650 3750 2650
Wire Wire Line
	3750 2750 3850 2750
Wire Wire Line
	3850 2850 3750 2850
Wire Wire Line
	3750 4650 3850 4650
Wire Wire Line
	3850 4750 3750 4750
Wire Wire Line
	3750 4850 3850 4850
Text Label 1350 2250 0    50   ~ 0
UART1_TX
Text Label 1350 2350 0    50   ~ 0
UART1_RX
Text Label 1350 2450 0    50   ~ 0
UART2_TX
Text Label 1350 2550 0    50   ~ 0
UART2_RX
Text Label 1350 3600 0    50   ~ 0
UART3_TX
Text Label 1350 3700 0    50   ~ 0
UART3_RX
$Comp
L power:+3.3V #PWR019
U 1 1 61A2A473
P 1450 2050
F 0 "#PWR019" H 1450 1900 50  0001 C CNN
F 1 "+3.3V" H 1465 2223 50  0000 C CNN
F 2 "" H 1450 2050 50  0001 C CNN
F 3 "" H 1450 2050 50  0001 C CNN
	1    1450 2050
	1    0    0    -1  
$EndComp
$Comp
L power:GND #PWR021
U 1 1 61A2AB85
P 1450 2750
F 0 "#PWR021" H 1450 2500 50  0001 C CNN
F 1 "GND" H 1455 2577 50  0000 C CNN
F 2 "" H 1450 2750 50  0001 C CNN
F 3 "" H 1450 2750 50  0001 C CNN
	1    1450 2750
	1    0    0    -1  
$EndComp
Wire Wire Line
	1350 2250 1250 2250
Wire Wire Line
	1250 2350 1350 2350
Wire Wire Line
	1350 2450 1250 2450
Wire Wire Line
	1250 2550 1350 2550
Wire Wire Line
	1350 3600 1250 3600
Wire Wire Line
	1250 3700 1350 3700
Wire Wire Line
	1250 2650 1450 2650
Wire Wire Line
	1450 2650 1450 2750
Wire Wire Line
	1450 2050 1450 2150
Wire Wire Line
	1450 2150 1250 2150
$Comp
L power:+3.3V #PWR023
U 1 1 61A3EEDE
P 1450 3400
F 0 "#PWR023" H 1450 3250 50  0001 C CNN
F 1 "+3.3V" H 1465 3573 50  0000 C CNN
F 2 "" H 1450 3400 50  0001 C CNN
F 3 "" H 1450 3400 50  0001 C CNN
	1    1450 3400
	1    0    0    -1  
$EndComp
$Comp
L power:GND #PWR025
U 1 1 61A3EEE4
P 1450 4100
F 0 "#PWR025" H 1450 3850 50  0001 C CNN
F 1 "GND" H 1455 3927 50  0000 C CNN
F 2 "" H 1450 4100 50  0001 C CNN
F 3 "" H 1450 4100 50  0001 C CNN
	1    1450 4100
	1    0    0    -1  
$EndComp
Wire Wire Line
	1250 4000 1450 4000
Wire Wire Line
	1450 4000 1450 4100
Wire Wire Line
	1450 3400 1450 3500
Wire Wire Line
	1450 3500 1250 3500
$Comp
L Connector_Generic:Conn_01x06 J11
U 1 1 61A4FE69
P 1050 3800
F 0 "J11" H 968 3275 50  0000 C CNN
F 1 "Conn_01x06" H 968 3366 50  0000 C CNN
F 2 "" H 1050 3800 50  0001 C CNN
F 3 "~" H 1050 3800 50  0001 C CNN
	1    1050 3800
	-1   0    0    1   
$EndComp
$Comp
L Connector_Generic:Conn_01x06 J10
U 1 1 61A546CA
P 1050 2450
F 0 "J10" H 968 1925 50  0000 C CNN
F 1 "Conn_01x06" H 968 2016 50  0000 C CNN
F 2 "" H 1050 2450 50  0001 C CNN
F 3 "~" H 1050 2450 50  0001 C CNN
	1    1050 2450
	-1   0    0    1   
$EndComp
Text Label 1350 3800 0    50   ~ 0
I2C2_SCL
Text Label 1350 3900 0    50   ~ 0
I2C2_SDA
Wire Wire Line
	1350 3800 1250 3800
Wire Wire Line
	1250 3900 1350 3900
$Comp
L Connector:TestPoint TP9
U 1 1 61A8EFBE
P 9950 2000
F 0 "TP9" V 10145 2072 50  0000 C CNN
F 1 "TestPoint" V 10054 2072 50  0000 C CNN
F 2 "" H 10150 2000 50  0001 C CNN
F 3 "~" H 10150 2000 50  0001 C CNN
	1    9950 2000
	0    -1   -1   0   
$EndComp
Text Label 10100 2000 0    50   ~ 0
USB_DEV1_D+
$Comp
L Connector:TestPoint TP10
U 1 1 61A90758
P 9950 2300
F 0 "TP10" V 10145 2372 50  0000 C CNN
F 1 "TestPoint" V 10054 2372 50  0000 C CNN
F 2 "" H 10150 2300 50  0001 C CNN
F 3 "~" H 10150 2300 50  0001 C CNN
	1    9950 2300
	0    -1   -1   0   
$EndComp
Text Label 10100 2300 0    50   ~ 0
USB_DEV1_D-
$Comp
L Connector:TestPoint TP11
U 1 1 61A93BF3
P 9950 2600
F 0 "TP11" V 10145 2672 50  0000 C CNN
F 1 "TestPoint" V 10054 2672 50  0000 C CNN
F 2 "" H 10150 2600 50  0001 C CNN
F 3 "~" H 10150 2600 50  0001 C CNN
	1    9950 2600
	0    -1   -1   0   
$EndComp
Text Label 10100 2600 0    50   ~ 0
USB_DEV2_D+
$Comp
L Connector:TestPoint TP12
U 1 1 61A96FF2
P 9950 2900
F 0 "TP12" V 10145 2972 50  0000 C CNN
F 1 "TestPoint" V 10054 2972 50  0000 C CNN
F 2 "" H 10150 2900 50  0001 C CNN
F 3 "~" H 10150 2900 50  0001 C CNN
	1    9950 2900
	0    -1   -1   0   
$EndComp
Text Label 10100 2900 0    50   ~ 0
USB_DEV2_D-
$Comp
L Connector:TestPoint TP13
U 1 1 61A9A32F
P 9950 3200
F 0 "TP13" V 10145 3272 50  0000 C CNN
F 1 "TestPoint" V 10054 3272 50  0000 C CNN
F 2 "" H 10150 3200 50  0001 C CNN
F 3 "~" H 10150 3200 50  0001 C CNN
	1    9950 3200
	0    -1   -1   0   
$EndComp
Text Label 10100 3200 0    50   ~ 0
SBU_1
$Comp
L Connector:TestPoint TP14
U 1 1 61A9D6B6
P 9950 3500
F 0 "TP14" V 10145 3572 50  0000 C CNN
F 1 "TestPoint" V 10054 3572 50  0000 C CNN
F 2 "" H 10150 3500 50  0001 C CNN
F 3 "~" H 10150 3500 50  0001 C CNN
	1    9950 3500
	0    -1   -1   0   
$EndComp
Text Label 10100 3500 0    50   ~ 0
SBU_2
Wire Wire Line
	9950 2000 10100 2000
Wire Wire Line
	10100 2300 9950 2300
Wire Wire Line
	10100 2600 9950 2600
Wire Wire Line
	9950 2900 10100 2900
Wire Wire Line
	10100 3200 9950 3200
Wire Wire Line
	9950 3500 10100 3500
$Comp
L Connector:TestPoint TP15
U 1 1 61AC146D
P 9950 3800
F 0 "TP15" V 10145 3872 50  0000 C CNN
F 1 "TestPoint" V 10054 3872 50  0000 C CNN
F 2 "" H 10150 3800 50  0001 C CNN
F 3 "~" H 10150 3800 50  0001 C CNN
	1    9950 3800
	0    -1   -1   0   
$EndComp
Text Label 10100 3800 0    50   ~ 0
USB_AUX_D+
$Comp
L Connector:TestPoint TP16
U 1 1 61AC1474
P 9950 4100
F 0 "TP16" V 10145 4172 50  0000 C CNN
F 1 "TestPoint" V 10054 4172 50  0000 C CNN
F 2 "" H 10150 4100 50  0001 C CNN
F 3 "~" H 10150 4100 50  0001 C CNN
	1    9950 4100
	0    -1   -1   0   
$EndComp
Text Label 10100 4100 0    50   ~ 0
USB_AUX_D-
Wire Wire Line
	10100 3800 9950 3800
Wire Wire Line
	9950 4100 10100 4100
$EndSCHEMATC
